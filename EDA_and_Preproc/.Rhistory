mutate(q15 = replace(q15, q15 == 1.0, "0 times")) %>%
mutate(q15 = replace(q15, q15 == 2.0, "1 time")) %>%
mutate(q15 = replace(q15, q15 == 3.0, "2 or 3 times")) %>%
mutate(q15 = replace(q15, q15 == 4.0, "4 or 5 times")) %>%
mutate(q15 = replace(q15, q15 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q16 = replace(q16, q16 == 1.0, "0 times")) %>%
mutate(q16 = replace(q16, q16 == 2.0, "1 time")) %>%
mutate(q16 = replace(q16, q16 == 3.0, "2 or 3 times")) %>%
mutate(q16 = replace(q16, q16 == 4.0, "4 or 5 times")) %>%
mutate(q16 = replace(q16, q16 == 5.0, "6 or 7 times")) %>%
mutate(q16 = replace(q16, q16 == 6.0, "8 or 9 times")) %>%
mutate(q16 = replace(q16, q16 == 7.0, "10 or 11 times")) %>%
mutate(q16 = replace(q16, q16 == 8.0, "12 or 7more times"))
cdc_data = cdc_data %>%
mutate(q17 = replace(q17, q17 == 1.0, "0 times")) %>%
mutate(q17 = replace(q17, q17 == 2.0, "1 time")) %>%
mutate(q17 = replace(q17, q17 == 3.0, "2 or 3 times")) %>%
mutate(q17 = replace(q17, q17 == 4.0, "4 or 5 times")) %>%
mutate(q17 = replace(q17, q17 == 5.0, "6 or 7 times")) %>%
mutate(q17 = replace(q17, q17 == 6.0, "8 or 9 times")) %>%
mutate(q17 = replace(q17, q17 == 7.0, "10 or 11 times")) %>%
mutate(q17 = replace(q17, q17 == 8.0, "12 or 7more times"))
cdc_data = cdc_data %>%
mutate(q18 = replace(q18, q18 == 1.0, "0 times")) %>%
mutate(q18 = replace(q18, q18 == 2.0, "1 time")) %>%
mutate(q18 = replace(q18, q18 == 3.0, "2 or 3 times")) %>%
mutate(q18 = replace(q18, q18 == 4.0, "4 or 5 times")) %>%
mutate(q18 = replace(q18, q18 == 5.0, "6 or 7 times")) %>%
mutate(q18 = replace(q18, q18 == 6.0, "8 or 9 times")) %>%
mutate(q18 = replace(q18, q18 == 7.0, "10 or 11 times")) %>%
mutate(q18 = replace(q18, q18 == 8.0, "12 or 7more times"))
cdc_data = cdc_data %>%
mutate(q19 = replace(q19, q19 == 1.0, "Yes")) %>%
mutate(q19 = replace(q19, q19 == 2.0, "No"))
cdc_data = cdc_data %>%
mutate(q20 = replace(q20, q20 == 1.0, "0 times")) %>%
mutate(q20 = replace(q20, q20 == 2.0, "1 time")) %>%
mutate(q20 = replace(q20, q20 == 3.0, "2 or 3 times")) %>%
mutate(q20 = replace(q20, q20 == 4.0, "4 or 5 times")) %>%
mutate(q20 = replace(q20, q20 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q21 = replace(q21, q21 == 1.0, "I did not date in the past 12 months")) %>%
mutate(q21 = replace(q21, q21 == 2.0, "0 times")) %>%
mutate(q21 = replace(q21, q21 == 3.0, "1 time")) %>%
mutate(q21 = replace(q21, q21 == 4.0, "2 or 3 times")) %>%
mutate(q21 = replace(q21, q21 == 5.0, "4 or 5 times")) %>%
mutate(q21 = replace(q21, q21 == 6.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q22 = replace(q22, q22 == 1.0, "I did not date in the past 12 months")) %>%
mutate(q22 = replace(q22, q22 == 2.0, "0 times")) %>%
mutate(q22 = replace(q22, q22 == 3.0, "1 time")) %>%
mutate(q22 = replace(q22, q22 == 4.0, "2 or 3 times")) %>%
mutate(q22 = replace(q22, q22 == 5.0, "4 or 5 times")) %>%
mutate(q22 = replace(q22, q22 == 6.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q23 = replace(q23, q23 == 1.0, "Yes")) %>%
mutate(q23 = replace(q23, q23 == 2.0, "No"))
cdc_data = cdc_data %>%
mutate(q24 = replace(q24, q24 == 1.0, "Yes")) %>%
mutate(q24 = replace(q24, q24 == 2.0, "No"))
## EDA, Demo
summarize(cdc_data, N_hat = sum(cdc_data$weight))
### weights
ggplot(data = cdc_data, mapping = aes(x = weight, color = raceeth)) +
geom_freqpoly(binwidth = 0.1)
ggplot(data = cdc_data, mapping = aes(x = weight, color = age)) +
geom_freqpoly(binwidth = 0.1)
ggplot(data = cdc_data, mapping = aes(x = weight, color = grade)) +
geom_freqpoly(binwidth = 0.1)
ggplot(data = cdc_data, mapping = aes(x = weight, color = Sex)) +
geom_freqpoly(binwidth = 0.1)
ggplot(data = cdc_data, mapping = aes(x = weight, color = sex_id)) +
geom_freqpoly(binwidth = 0.1)
##### Stacked bar Demo
### weighted
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip()
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip()
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip()
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = grade), position = "fill") +
coord_flip()
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = Sex), position = "fill") +
coord_flip()
ggplot2::cdc_data %>% count(q13, age) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
cdc_data %>% ggplot2(count(q13, age)) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
cdc_data %>% ggplot(count(q13, age)) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
cdc_data %>% ggplot(count(q13, age)) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = Sex), position = "fill") +
coord_flip()
cdc_data %>% ggplot(count(q13, age)) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
ggplot(cdc_data, count(q13, age)) %>%
plot_ly(x = ~q13, y = ~n, color = ~age)
plot_ly(cdc_data,x = ~q13, y = ~n, color = ~age)
p <- plot_ly(cdc_data, x = ~q13, y = ~Sex, type = 'bar', name = 'Weapon Garry by Gender ID') %>%
add_trace(y = ~Sex, name = 'Gender') %>%
layout(yaxis = list(title = 'Count'), barmode = 'stack')
p
p <- plot_ly(cdc_data, x = ~q13, y = ~Sex, type = 'bar', name = 'Weapon Garry by Gender ID', weight = weight) %>%
add_trace(y = ~Sex, name = 'Gender') %>%
layout(yaxis = list(title = 'Count'), barmode = 'stack')
p <- plot_ly(cdc_data, x = ~q13, y = ~Sex, type = 'bar', name = 'Male',) %>%
add_trace(y = ~Sex, name = 'Gender') %>%
layout(yaxis = list(title = 'Count'), barmode = 'stack')
p <- plot_ly(cdc_data, x = ~q13, y = ~Sex, type = 'bar', name = 'Male') %>%
add_trace(y = ~Sex, name = 'Gender') %>%
layout(yaxis = list(title = 'Count'), barmode = 'stack')
p
p <- plot_ly(cdc_data, x = ~q13, y = ~Sex, type = 'bar', name = 'Male') %>%
add_trace(y = ~Sex, name = 'Female') %>%
layout(yaxis = list(title = 'Count'), barmode = 'stack')
pp
p
##### Stacked bar Demo
### unweighted
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip()
print(plot + ggtitle("weapons and ethnicity weighted"))
plot = cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip()
print(plot + ggtitle("weapons and ethnicity weighted"))
print(plot + labs(y="Count", x = "Weapons carry"))
print(plot + labs(y="Count", x = "Weapons Carry"))
print(plot + ggtitle("Weapons and Ethnicity Weighted"))
print(plot + labs(y="Count", x = "Weapons Carry"))
print(plot + ggtitle("Weapons and Ethnicity Weighted") +
labs(y="Count", x = "Weapons Carry"))
print(plot + ggtitle("Weapons and Ethnicity Unweighted") +
labs(y="Count", x = "Weapons Carry"))
print(plot + ggtitle("Weapons and Ethnicity Unweighted") +
labs(y="Count", x = "Weapons Carry"))
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Unweighted") +
labs(y="Count", x = "Weapons Carry"))
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Unweighted") +
labs(y="Count", x = "Weapons Carry"))
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Unweighted") +
labs(y="Count", x = "Weapons Carry")
##### Stacked bar Demo
### weighted
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Weighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Weapons and Age Weighted") +
labs(y="Count", x = "Weapons Carry")
x = q13, weight = weight)) +
geom_bar(ae
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip() +
ggtitle("Weapons and Sexual Identity Weighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip() +
ggtitle("Weapons and Sexual Identity Weighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = grade), position = "fill") +
coord_flip() +
ggtitle("Weapons and Grade Weighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = Sex), position = "fill") +
coord_flip() +
ggtitle("Weapons and Gender Weighted") +
labs(y="Count", x = "Weapons Carry")
ggplot(data = cdc_data) +
geom_boxplot(
mapping=aes(
x=reorder(q13, q7, FUN = median), weight = weight,
y = q7
) +
ggtitle("Weapons and Body Weight Weighted") +
labs(y="Count", x = "Weapons Carry")
)
mapping=aes(
x=reorder(q13, q7, FUN = median), weight = weight,
y = q7
)) +
ggtitle("Weapons and Body Weight Weighted") +
labs(y="Count", x = "Weapons Carry")
box = ggplot(data = cdc_data) +
geom_boxplot(
mapping=aes(
x=reorder(q13, q7, FUN = median), weight = weight,
y = q7
))
box + ggtitle("Weapons and Body Weight Weighted") +
labs(y="Count", x = "Weapons Carry")
##### Stacked bar Demo
### unweighted
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Uneighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Weapons and Age Unweighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip() +
ggtitle("Weapons and Sexual Identity Unweighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = grade), position = "fill") +
coord_flip() +
ggtitle("Weapons and Grade Unweighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q13)) +
geom_bar(aes(fill = Sex), position = "fill") +
coord_flip() +
ggtitle("Weapons and Gender Unweighted") +
labs(y="Count", x = "Weapons Carry")
box2 = ggplot(data = cdc_data) +
geom_boxplot(
mapping=aes(
x=reorder(q13, q7, FUN = median),
y = q7
)
)
box2 + ggtitle("Weapons and Body Weight Unweighted") +
labs(y="Count", x = "Weapons Carry")
cdc_data %>%
ggplot(aes(x = q16, weight = weight )) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip()
cdc_data = cdc_data %>%
mutate(q16 = replace(q16, q16 == 1.0, "0 times")) %>%
mutate(q16 = replace(q16, q16 == 2.0, "1 time")) %>%
mutate(q16 = replace(q16, q16 == 3.0, "2 or 3 times")) %>%
mutate(q16 = replace(q16, q16 == 4.0, "4 or 5 times")) %>%
mutate(q16 = replace(q16, q16 == 5.0, "6 or 7 times")) %>%
mutate(q16 = replace(q16, q16 == 6.0, "8 or 9 times")) %>%
mutate(q16 = replace(q16, q16 == 7.0, "10 or 11 times")) %>%
mutate(q16 = replace(q16, q16 == 8.0, "12 or more times"))
cdc_data %>%
ggplot(aes(x = q16, weight = weight )) +
geom_bar(aes(fill = sex_id), position = "fill") +
coord_flip() +
ggtitle("Weapons and Grade Unweighted") +
labs(y="Count", x = "Weapons Carry")
library(ggplot2)
library(plotly)
library(dplyr)
library(survey)
cdc_data = read.csv('cdc_data_noNA.csv')
dim(cdc_data)
### Imputing real value names from survey
cdc_data %>%
mutate(q8 = replace(q8, q8 == 1.0, "Never")) %>%
mutate(q8 = replace(q8, q8 == 2.0, "Rarely")) %>%
mutate(q8 = replace(q8, q8 == 3.0, "Sometimes")) %>%
mutate(q8 = replace(q8, q8 == 4.0, "Most of the Time")) %>%
mutate(q8 = replace(q8, q8 == 5.0, "Always"))
cdc_data = cdc_data %>%
mutate(q13 = replace(q13, q13 == 1.0, "0 times")) %>%
mutate(q13 = replace(q13, q13 == 2.0, "1 time")) %>%
mutate(q13 = replace(q13, q13 == 3.0, "2 or 3 times")) %>%
mutate(q13 = replace(q13, q13 == 4.0, "4 or 5 times")) %>%
mutate(q13 = replace(q13, q13 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q12 = replace(q12, q12 == 1.0, "0 times")) %>%
mutate(q12 = replace(q12, q12 == 2.0, "1 time")) %>%
mutate(q12 = replace(q12, q12 == 3.0, "2 or 3 times")) %>%
mutate(q12 = replace(q12, q12 == 4.0, "4 or 5 times")) %>%
mutate(q12 = replace(q12, q12 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q14 = replace(q14, q14 == 1.0, "0 times")) %>%
mutate(q14 = replace(q14, q14 == 2.0, "1 time")) %>%
mutate(q14 = replace(q14, q14 == 3.0, "2 or 3 times")) %>%
mutate(q14 = replace(q14, q14 == 4.0, "4 or 5 times")) %>%
mutate(q14 = replace(q14, q14 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q15 = replace(q15, q15 == 1.0, "0 times")) %>%
mutate(q15 = replace(q15, q15 == 2.0, "1 time")) %>%
mutate(q15 = replace(q15, q15 == 3.0, "2 or 3 times")) %>%
mutate(q15 = replace(q15, q15 == 4.0, "4 or 5 times")) %>%
mutate(q15 = replace(q15, q15 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q16 = replace(q16, q16 == 1.0, "0 times")) %>%
mutate(q16 = replace(q16, q16 == 2.0, "1 time")) %>%
mutate(q16 = replace(q16, q16 == 3.0, "2 or 3 times")) %>%
mutate(q16 = replace(q16, q16 == 4.0, "4 or 5 times")) %>%
mutate(q16 = replace(q16, q16 == 5.0, "6 or 7 times")) %>%
mutate(q16 = replace(q16, q16 == 6.0, "8 or 9 times")) %>%
mutate(q16 = replace(q16, q16 == 7.0, "10 or 11 times")) %>%
mutate(q16 = replace(q16, q16 == 8.0, "12 or more times"))
cdc_data = cdc_data %>%
mutate(q17 = replace(q17, q17 == 1.0, "0 times")) %>%
mutate(q17 = replace(q17, q17 == 2.0, "1 time")) %>%
mutate(q17 = replace(q17, q17 == 3.0, "2 or 3 times")) %>%
mutate(q17 = replace(q17, q17 == 4.0, "4 or 5 times")) %>%
mutate(q17 = replace(q17, q17 == 5.0, "6 or 7 times")) %>%
mutate(q17 = replace(q17, q17 == 6.0, "8 or 9 times")) %>%
mutate(q17 = replace(q17, q17 == 7.0, "10 or 11 times")) %>%
mutate(q17 = replace(q17, q17 == 8.0, "12 or 7more times"))
cdc_data = cdc_data %>%
mutate(q18 = replace(q18, q18 == 1.0, "0 times")) %>%
mutate(q18 = replace(q18, q18 == 2.0, "1 time")) %>%
mutate(q18 = replace(q18, q18 == 3.0, "2 or 3 times")) %>%
mutate(q18 = replace(q18, q18 == 4.0, "4 or 5 times")) %>%
mutate(q18 = replace(q18, q18 == 5.0, "6 or 7 times")) %>%
mutate(q18 = replace(q18, q18 == 6.0, "8 or 9 times")) %>%
mutate(q18 = replace(q18, q18 == 7.0, "10 or 11 times")) %>%
mutate(q18 = replace(q18, q18 == 8.0, "12 or 7more times"))
cdc_data = cdc_data %>%
mutate(q19 = replace(q19, q19 == 1.0, "Yes")) %>%
mutate(q19 = replace(q19, q19 == 2.0, "No"))
cdc_data = cdc_data %>%
mutate(q20 = replace(q20, q20 == 1.0, "0 times")) %>%
mutate(q20 = replace(q20, q20 == 2.0, "1 time")) %>%
mutate(q20 = replace(q20, q20 == 3.0, "2 or 3 times")) %>%
mutate(q20 = replace(q20, q20 == 4.0, "4 or 5 times")) %>%
mutate(q20 = replace(q20, q20 == 5.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q21 = replace(q21, q21 == 1.0, "I did not date in the past 12 months")) %>%
mutate(q21 = replace(q21, q21 == 2.0, "0 times")) %>%
mutate(q21 = replace(q21, q21 == 3.0, "1 time")) %>%
mutate(q21 = replace(q21, q21 == 4.0, "2 or 3 times")) %>%
mutate(q21 = replace(q21, q21 == 5.0, "4 or 5 times")) %>%
mutate(q21 = replace(q21, q21 == 6.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q22 = replace(q22, q22 == 1.0, "I did not date in the past 12 months")) %>%
mutate(q22 = replace(q22, q22 == 2.0, "0 times")) %>%
mutate(q22 = replace(q22, q22 == 3.0, "1 time")) %>%
mutate(q22 = replace(q22, q22 == 4.0, "2 or 3 times")) %>%
mutate(q22 = replace(q22, q22 == 5.0, "4 or 5 times")) %>%
mutate(q22 = replace(q22, q22 == 6.0, "6 or more times"))
cdc_data = cdc_data %>%
mutate(q23 = replace(q23, q23 == 1.0, "Yes")) %>%
mutate(q23 = replace(q23, q23 == 2.0, "No"))
cdc_data = cdc_data %>%
mutate(q24 = replace(q24, q24 == 1.0, "Yes")) %>%
mutate(q24 = replace(q24, q24 == 2.0, "No"))
## EDA, Demo
summarize(cdc_data, N_hat = sum(cdc_data$weight))
##### Stacked bar Demo
### weighted
cdc_data %>%
ggplot(aes(x = q13, weight = weight)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip() +
ggtitle("Weapons and Ethnicity Weighted") +
labs(y="Count", x = "Weapons Carry")
##### Stacked bar Demo
### weighted
cdc_data %>%
ggplot(aes(x = q14, weight = weight)) +
geom_bar(aes(fill = raceeth), position = "fill") +
coord_flip() +
ggtitle("Gun Carry and Ethnicity Weighted") +
labs(y="Count", x = "Carried Gun")
cdc_data %>%
ggplot(aes(x = q14, weight = weight)) +
geom_bar(aes(fill = age), position = "fill") +
coord_flip() +
ggtitle("Gun Carry and Age Weighted") +
labs(y="Count", x = "Carried Gun")
##### tables
table(cdc_data$q14)/nrow(cdc_data)
##### tables
table(cdc_data$q12)/nrow(cdc_data)
table(cdc_data$q13)/nrow(cdc_data)
table(cdc_data$q14/nrow(cdc_data))
table(cdc_data$q14)/nrow(cdc_data)
table3 = (cdc_data$q14)/nrow(cdc_data)
table3 = (cdc_data$q14)/nrow(cdc_data)
table3 = table(cdc_data$q14)/nrow(cdc_data)
table3
install.packages('data.table')
install.packages("data.table")
library(data.table)
install.packages('formattable')
library(formattable)
##### tables
formattable(table(cdc_data$q12)/nrow(cdc_data))
##### tables
formattable(table(cdc_data$q12)/nrow(cdc_data))
##### tables
t1 = table(cdc_data$q12)/nrow(cdc_data)
t2 = table(cdc_data$q13)/nrow(cdc_data)
t3 = table(cdc_data$q14)/nrow(cdc_data)
formattable(t1)
## models
bad.model = lm(admit ~ q13., , data = cdc_data)
## models
bad.model = lm(q13 ~., data = cdc_data)
####
is.na(cdc_data)
####
sum(is.na(cdc_data))
## models
bad.model = lm( q13 ~, data = cdc_data)
## models
bad.model = lm( q13 ~ data = cdc_data)
head(cdc_data)
## models
bad.model = lm( q13 ~ -X, data = cdc_data)
## models
bad.model = lm( q13 ~ Sex + raceeth + sex_id + weight + age + grade, data = cdc_data)
summary(bad.model) #Looks like everything is significant, so what's bad?
plot(bad.model) #Severe violations to the assumptions of linear regression.
## models
bad.model = lm( q13 ~ Sex + raceeth + sex_id + weight + age + grade, data = cdc_data)
## models
bad.model = lm(q13 ~ Sex + raceeth + sex_id + weight + age + grade, data = cdc_data)
summary(bad.model) #Looks like everything is significant, so what's bad?
plot(bad.model) #Severe violations to the assumptions of linear regression.
summary(bad.model$fitted.values)
## models
model = lm(q13 ~ Sex + raceeth + sex_id + weight + age + grade, data = cdc_data)
## models
model = lm(q13 ~ Sex + raceeth + sex_id + weight + age + grade, data = cdc_data)
## models
model = lm(q13 ~ Sex, data = cdc_data)
library(randomForest)
install.packages('randomForest')
install.packages("randomForest")
##### tables
tbl = table(cdc_data$a13, cdc_data$raceeth)
##### tables
tbl = table(cdc_data$q13, cdc_data$raceeth)
tbl
formattable(tbl)
formattable(t1)
tbl
formattable(tbl)
library(tidyr)
library(ggplot2)
library(plotly)
library(dplyr)
library(survey)
library(data.table)
library(formattable)
library(tidyr)
##### tables
tbl = table(cdc_data$q13, cdc_data$raceeth)
formattable(tbl)
formattable(tbl)
##### tables
tbl = table(cdc_data$q13, cdc_data$raceeth, weight = weight)
##### tables
tbl = table(cdc_data$q13, cdc_data$raceeth, w = weight)
##### tables
tbl = table(cdc_data$q13, cdc_data$raceeth)
formattable(tbl)
formattable(cdc_data,
formattable(cdc_data,
align = c("l",rep("r", NCOL(cdc_data) - 1)),
list(`Indicator Name` = formatter("span", style = ~ style(color = "grey", font.weight = "bold")),
`Average` = color_bar("#FA614B"),
`Improvement` = percent))
cdc_data[, "q14"] = cdc_data[, "q14"] / 100
formattable(cdc_data,
align = c("l",rep("r", NCOL(cdc_data) - 1)),
list(`Indicator Name` = formatter("span", style = ~ style(color = "grey", font.weight = "bold")),
`Average` = color_bar("#FA614B"),
`Improvement` = percent))
